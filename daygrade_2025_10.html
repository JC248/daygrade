<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Day Grade - 2025ÎÖÑ 10Ïõî</title>
  <style>
*{box-sizing:border-box}
:root{ --gold:#FFD700; --red:#FF4D4D; --orange:#FFA500; --yellow:#FFEB3B; --gray:#BDBDBD; --black:#000000;
       --bg:#0b0c10; --surface:#12131a; --text:#E6E6E6; --muted:#A9A9A9; --accent:#7aa2ff; --ring:#3b82f6; }
html,body{height:100%}
body{ margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple SD Gothic Neo, 'Malgun Gothic', Arial, sans-serif;
       background: radial-gradient(1200px 800px at 10% -10%, #1b1d2b 0, #0b0c10 60%); color:var(--text);}
.app-bar{display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid #202235;
  background: linear-gradient(180deg, #12131a 0, #10111a 100%); position:sticky; top:0; z-index:10;}
.app-bar h1{font-size:18px;margin:0}
.nav{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
.nav .label{font-weight:700; min-width:170px; text-align:center}
.nav a, .nav button{background:#1a1c28; color:var(--text); border:1px solid #2a2d45; border-radius:8px; padding:8px 10px; cursor:pointer; text-decoration:none}
.nav a:hover, .nav button:hover{border-color:#3b3f65}
.container{max-width:980px; margin:18px auto; padding:0 16px}
.legend{display:flex; flex-wrap:wrap; gap:12px; margin-bottom:12px; font-size:14px; color:var(--muted)}
.legend .box{display:inline-block; width:14px; height:14px; margin-right:6px; border-radius:3px; border:1px solid #0005}
.legend .s{background:#FFD700} .legend .a{background:#FF4D4D} .legend .b{background:#FFA500}
.legend .c{background:#FFEB3B} .legend .d{background:#BDBDBD} .legend .f{background:#000000}
.calendar{display:grid; grid-template-columns: repeat(7,1fr); gap:8px; background:#0e0f17; border:1px solid #202235; border-radius:14px; padding:12px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);}
.dow{text-align:center; font-weight:600; color:var(--muted); padding:6px 0}
.day{position:relative; min-height:92px; background:#12131a; border:1px solid #1f2238; border-radius:12px; color:var(--text);
  text-align:left; padding:10px; cursor:pointer; transition:transform .06s ease, border-color .2s ease, background .2s ease;}
.day:hover{ transform: translateY(-1px); border-color:#2d3156; }
.day time{font-weight:700; font-size:14px}
.day .badge{position:absolute; right:10px; top:10px; font-size:12px; opacity:.85; padding:2px 6px; border-radius:999px; border:1px solid #0003;}
.day .note-dot{position:absolute; left:10px; bottom:10px; width:6px; height:6px; border-radius:50%; background:var(--accent);}
.day.today{outline:2px solid var(--ring); outline-offset:2px;}
.day.grade-S{ background: color-mix(in oklab, #FFD700 38%, #12131a); border-color: color-mix(in oklab, #FFD700 60%, #1f2238); }
.day.grade-A{ background: color-mix(in oklab, #FF4D4D 38%, #12131a); border-color: color-mix(in oklab, #FF4D4D 60%, #1f2238); }
.day.grade-B{ background: color-mix(in oklab, #FFA500 36%, #12131a); border-color: color-mix(in oklab, #FFA500 60%, #1f2238); }
.day.grade-C{ background: color-mix(in oklab, #FFEB3B 36%, #12131a); border-color: color-mix(in oklab, #FFEB3B 60%, #1f2238); color:#111; }
.day.grade-D{ background: color-mix(in oklab, #BDBDBD 36%, #12131a); border-color: color-mix(in oklab, #BDBDBD 60%, #1f2238); color:#111; }
.day.grade-F{ background: color-mix(in oklab, #000000 70%, #12131a); border-color: color-mix(in oklab, #000000 80%, #1f2238); }
.day.grade-A .badge, .day.grade-B .badge, .day.grade-F .badge{ background:#0009; color:#fff }
.day.grade-S .badge{ background:#0007; color:#fff }
.day.grade-C .badge, .day.grade-D .badge{ background:#fff9; color:#111 }
.stats{margin:14px 4px 0; font-size:14px; color:var(--muted); display:flex; flex-wrap:wrap; gap:10px; align-items:center;}
.stats .pill{padding:6px 10px; border:1px solid #2a2d45; border-radius:999px; background:#141625; color:var(--text);}
.controls{display:flex; gap:8px; flex-wrap:wrap; margin:12px 4px}
.controls button, .controls a{background:#1a1c28; color:var(--text); border:1px solid #2a2d45; border-radius:8px; padding:8px 12px; cursor:pointer; text-decoration:none}
.controls .primary{background:var(--accent); color:#0a0c12; border:none}
.controls .danger{background:#311; color:#fbb; border:1px solid #522}
.print-summary{display:none}
@media print { .app-bar, .controls, .legend { display:none !important; } .print-summary { display:block; } body{ background:#fff; color:#000 } .calendar{ box-shadow:none } }
  </style>
</head>
<body>
  <header class="app-bar">
    <h1>üìÖ Day Grade</h1>
    <nav class="nav">
      <a href="daygrade_2025_09.html" aria-label="Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄ">‚óÄ Ïù¥Ï†Ñ</a>
      <div class="label">2025ÎÖÑ 10Ïõî</div>
      <a href="daygrade_2025_11.html" aria-label="Îã§Ïùå ÌéòÏù¥ÏßÄ">Îã§Ïùå ‚ñ∂</a>
    </nav>
  </header>

  <main class="container">
    <section class="legend">
      <span><i class="box s"></i>S (Gold)</span>
      <span><i class="box a"></i>A (Red)</span>
      <span><i class="box b"></i>B (Orange)</span>
      <span><i class="box c"></i>C (Yellow)</span>
      <span><i class="box d"></i>D (Gray)</span>
      <span><i class="box f"></i>F (Black)</span>
    </section>

    <section class="calendar" id="calendar" aria-label="ÏõîÍ∞Ñ Ï∫òÎ¶∞Îçî">
      <div class="dow">Ïùº</div><div class="dow">Ïõî</div><div class="dow">Ìôî</div><div class="dow">Ïàò</div><div class="dow">Î™©</div><div class="dow">Í∏à</div><div class="dow">ÌÜ†</div>
    </section>

    <section class="stats" id="stats" aria-live="polite"></section>

    <section class="controls">
      <button id="exportBtn">ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
      <label class="import-label" style="border:1px dashed #2a2d45; padding:8px 12px; border-radius:8px; cursor:pointer; background:#131523">
        Î∂àÎü¨Ïò§Í∏∞ <input type="file" id="importInput" accept="application/json" hidden>
      </label>
      <button id="clearBtn" class="danger">Ïù¥ Îã¨ Ï¥àÍ∏∞Ìôî</button>
      <button id="printBtn" class="primary">ÌîÑÎ¶∞Ìä∏</button>
    </section>

    <section class="print-summary" id="printSummary"></section>
  </main>

  <template id="dayCellTemplate">
    <button class="day" type="button">
      <time></time>
      <span class="badge" aria-hidden="true"></span>
    </button>
  </template>

  <dialog id="editor">
    <form method="dialog" id="editorForm">
      <header class="dialog-header" style="display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #23263c">
        <h3 id="editorDate" style="margin:0;font-size:16px">YYYY-MM-DD</h3>
        <button value="cancel" aria-label="Îã´Í∏∞" style="background:#181a28;border:1px solid #2a2d45;border-radius:8px;color:#bbb;padding:6px 8px;cursor:pointer">‚úï</button>
      </header>
      <div class="grade-grid" style="display:grid;grid-template-columns:repeat(7,1fr);gap:8px;padding:16px">
        <button type="button" data-grade="S" class="grade s">S</button>
        <button type="button" data-grade="A" class="grade a">A</button>
        <button type="button" data-grade="B" class="grade b">B</button>
        <button type="button" data-grade="C" class="grade c">C</button>
        <button type="button" data-grade="D" class="grade d">D</button>
        <button type="button" data-grade="F" class="grade f">F</button>
        <button type="button" data-grade="" class="grade clear">ÏßÄÏö∞Í∏∞</button>
      </div>
      <label style="display:block;padding:0 16px 12px">
        Î©îÎ™® (ÏÑ†ÌÉù)
        <textarea id="noteInput" rows="3" placeholder="Ïò§Îäò ÏÉùÏÇ∞ÏÑ±Ïóê ÎåÄÌïú Í∞ÑÎã® Î©îÎ™®" style="width:100%;resize:vertical;background:#0f111a;color:var(--text);border:1px solid #2a2d45;border-radius:10px;padding:10px"></textarea>
      </label>
      <menu style="display:flex;justify-content:flex-end;gap:8px;padding:12px 16px;border-top:1px solid #23263c">
        <button value="cancel">Ï∑®ÏÜå</button>
        <button id="saveBtn" value="default" class="primary">Ï†ÄÏû•</button>
      </menu>
    </form>
  </dialog>

  <script>
(() => {
  const YEAR = 2025;
  const MONTH = 10; // 1-12

  const $ = (s, root=document) => root.querySelector(s);
  const $$ = (s, root=document) => Array.from(root.querySelectorAll(s));

  const STORAGE_KEY = 'daygrade-v2'; // shared across all months
  const POINTS = { S:5, A:4, B:3, C:2, D:1, F:0 };

  const cal = $('#calendar');
  const editor = $('#editor');
  const editorDate = $('#editorDate');
  const noteInput = $('#noteInput');
  const printSummary = $('#printSummary');

  let currentDateKey = null;
  let selectedGrade = '';

  function pad(n){ return String(n).padStart(2,'0'); }
  function keyOf(y,m,d){ return `${y}-${pad(m)}-${pad(d)}`; }
  function parseKey(k){ const [y,m,d]=k.split('-').map(Number); return new Date(y,m-1,d); }

  function load(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY))||{}; }catch{ return {}; } }
  function save(data){ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

  function renderCalendar(){
    $$('.day', cal).forEach(el => el.remove());
    const first = new Date(YEAR, MONTH-1, 1);
    const startDay = first.getDay();
    const last = new Date(YEAR, MONTH, 0).getDate();
    for(let i=0;i<startDay;i++){ cal.appendChild(document.createElement('div')); }
    const tpl = $('#dayCellTemplate');
    const today = new Date();
    const data = load();

    for(let d=1; d<=last; d++){ 
      const node = tpl.content.firstElementChild.cloneNode(true);
      $('time', node).textContent = d;
      const k = keyOf(YEAR, MONTH, d);
      node.dataset.key = k;

      if(today.getFullYear()===YEAR && (today.getMonth()+1)===MONTH && today.getDate()===d){
        node.classList.add('today');
      }
      const rec = data[k];
      if(rec?.grade){
        node.classList.add(`grade-${rec.grade}`);
        const badge = $('.badge', node);
        badge.textContent = rec.grade; badge.title = rec.grade;
      } else { $('.badge', node).style.display = 'none'; }
      if(rec?.note){ const dot = document.createElement('span'); dot.className='note-dot'; node.appendChild(dot); }
      node.addEventListener('click', () => openEditor(k));
      cal.appendChild(node);
    }
    renderStats();
  }

  function renderStats(){
    const start = new Date(YEAR, MONTH-1, 1);
    const end = new Date(YEAR, MONTH, 0);
    const data = load();
    const counts = {S:0,A:0,B:0,C:0,D:0,F:0};
    let sum=0, n=0;
    for(const [k,rec] of Object.entries(data)){
      const dt = parseKey(k);
      if(dt>=start && dt<=end && rec.grade){ counts[rec.grade]++; sum += POINTS[rec.grade]; n++; }
    }
    const gpa = n? (sum/n).toFixed(2) : '-';
    $('#stats').innerHTML = `
      <span class="pill">Ïù¥Îã¨ ÌèâÍ∑† Ï†êÏàò: ${gpa} / 5</span>
      <span class="pill">S:${counts.S}</span>
      <span class="pill">A:${counts.A}</span>
      <span class="pill">B:${counts.B}</span>
      <span class="pill">C:${counts.C}</span>
      <span class="pill">D:${counts.D}</span>
      <span class="pill">F:${counts.F}</span>
    `;
  }

  function openEditor(k){
    currentDateKey = k;
    const data = load();
    const rec = data[k]||{};
    selectedGrade = rec.grade || '';
    noteInput.value = rec.note || '';
    editorDate.textContent = k + (rec.grade? ` ¬∑ ÌòÑÏû¨ Îì±Í∏â: ${rec.grade}` : '');
    if(typeof editor.showModal==='function') editor.showModal(); else editor.setAttribute('open','');
  }

  // dialog grade buttons
  $$('.grade').forEach(btn => btn.addEventListener('click', () => { selectedGrade = btn.dataset.grade || ''; $('#saveBtn').focus(); } ));
  $('#editor').addEventListener('close', () => { currentDateKey=null; selectedGrade=''; noteInput.value=''; });
  $('#editorForm').addEventListener('submit', (e) => {
    e.preventDefault();
    if(!currentDateKey) return;
    const data = load();
    const note = noteInput.value.trim();
    if(!selectedGrade && !note){ delete data[currentDateKey]; }
    else { data[currentDateKey] = { grade: selectedGrade||undefined, note: note||undefined }; }
    save(data);
    renderCalendar();
    editor.close();
  });

  // import/export
  $('#exportBtn').addEventListener('click', () => {
    const blob = new Blob([JSON.stringify(load(), null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'daygrade-backup.json'; a.click(); URL.revokeObjectURL(url);
  });
  $('#importInput').addEventListener('change', async (e) => {
    const f = e.target.files[0]; if(!f) return;
    try{ const text = await f.text(); const obj = JSON.parse(text); if(typeof obj!=='object') throw new Error('ÌòïÏãù Ïò§Î•ò');
      save(obj); renderCalendar(); alert('Î∂àÎü¨Ïò§Í∏∞ ÏôÑÎ£å'); }
    catch(err){ alert('Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®: ' + err.message); }
    finally{ e.target.value=''; }
  });
  $('#clearBtn').addEventListener('click', () => {
    if(!confirm('Ïù¥ Îã¨Ïùò Îì±Í∏âÏùÑ Î™®Îëê ÏßÄÏö∏ÍπåÏöî?')) return;
    const data = load();
    const last = new Date(YEAR, MONTH, 0).getDate();
    for(let d=1; d<=last; d++){ delete data[keyOf(YEAR, MONTH, d)]; }
    save(data); renderCalendar();
  });

  // PRINT summary across Aug-Dec 2025
  $('#printBtn').addEventListener('click', () => {
    const data = load();
    const months = [
      { y:2025, m:8, label:'2025-08' },
      { y:2025, m:9, label:'2025-09' },
      { y:2025, m:10, label:'2025-10' },
      { y:2025, m:11, label:'2025-11' },
      { y:2025, m:12, label:'2025-12' },
    ];
    const countsTotal = {S:0,A:0,B:0,C:0,D:0,F:0}, summary=[];
    let sumAll=0, nAll=0;

    for(const mo of months){
      const start = new Date(mo.y, mo.m-1, 1);
      const end = new Date(mo.y, mo.m, 0);
      const counts = {S:0,A:0,B:0,C:0,D:0,F:0};
      let sum=0, n=0;
      for(const [k,rec] of Object.entries(data)){
        const dt = parseKey(k);
        if(dt>=start && dt<=end && rec.grade){ counts[rec.grade]++; sum += POINTS[rec.grade]; n++; }
      }
      const gpa = n? (sum/n).toFixed(2) : '-';
      summary.push({ label: mo.label, counts, gpa, gradedDays:n });
      for(const g of Object.keys(counts)) countsTotal[g]+=counts[g];
      sumAll += sum; nAll += n;
    }
    const gpaAll = nAll? (sumAll/nAll).toFixed(2) : '-';

    const rows = summary.map(s => `
      <tr>
        <td>${s.label}</td>
        <td>${s.gpa}</td>
        <td>${s.counts.S}</td>
        <td>${s.counts.A}</td>
        <td>${s.counts.B}</td>
        <td>${s.counts.C}</td>
        <td>${s.counts.D}</td>
        <td>${s.counts.F}</td>
        <td>${s.gradedDays}</td>
      </tr>
    `).join('');

    printSummary.innerHTML = `
      <h2>ÏÉùÏÇ∞ÏÑ± ÏöîÏïΩ (2025-08 ~ 2025-12)</h2>
      <table border="1" cellspacing="0" cellpadding="6" style="border-collapse:collapse; width:100%">
        <thead><tr style="background:#f2f2f2"><th>Ïõî</th><th>ÌèâÍ∑† Ï†êÏàò</th><th>S</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>Îì±Í∏âÏùºÏàò</th></tr></thead>
        <tbody>${rows}</tbody>
        <tfoot>
          <tr style="font-weight:700;background:#f9f9f9">
            <td>Ï†ÑÏ≤¥(ÌèâÍ∑†)</td>
            <td>${gpaAll}</td>
            <td>${countsTotal.S}</td>
            <td>${countsTotal.A}</td>
            <td>${countsTotal.B}</td>
            <td>${countsTotal.C}</td>
            <td>${countsTotal.D}</td>
            <td>${countsTotal.F}</td>
            <td>${nAll}</td>
          </tr>
        </tfoot>
      </table>
      <p style="margin-top:8px;font-size:12px;color:#555">S=5, A=4, B=3, C=2, D=1, F=0 Í∏∞Ï§Ä</p>
    `;
    window.print();
  });

  renderCalendar();
})();
  </script>
</body>
</html>
